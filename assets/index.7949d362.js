var R=Object.defineProperty,U=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var v=(e,o,n)=>o in e?R(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,g=(e,o)=>{for(var n in o||(o={}))L.call(o,n)&&v(e,n,o[n]);if(j)for(var n of j(o))x.call(o,n)&&v(e,n,o[n]);return e},I=(e,o)=>U(e,q(o));import{_ as A}from"./PageWrapper.66af3ba5.js";import{_ as E}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.e72b7a76.js";import{at as B,au as W,A as Q,b as C,b2 as F,a7 as K,o as V,f as w,w as l,a0 as N,h as a,g as S,x as p,t as G,aq as H,av as J,aw as M,ax as O,ay as T,az as X,d as Y,aA as Z,aB as $,aC as ee,aD as oe,U as te}from"./vendor.55f737cb.js";/* empty css                          *//* empty css                      *//* empty css                */import{_ as P}from"./BasicQuery.f1bf1e6f.js";import{_ as z,u as ae,a as le}from"./useResourceApi.c484f319.js";/* empty css                     *//* empty css                       *//* empty css                        */import{_ as D,i as _}from"./index.2338912f.js";import"./Form.83f0ddb3.js";/* empty css                 *//* empty css               */import"https://at.alicdn.com/t/font_2915553_2xnkr1mdevd.js";import"https://at.alicdn.com/t/font_2915337_b0wn8zcpm25.js";import"https://at.alicdn.com/t/font_1804572_162pxjij64s.js";const ne={name:"editTemplate",components:{BasicDrawer:z},setup(){const e=B({defaultCheckedKeys:[],rules:{name:[{required:!0,pattern:/^(\w|:){3,50}$/,message:"\u6807\u8BC6\u4E3A\u5FC5\u586B\u9879\uFF0C3-50\u4E2A\u82F1\u6587\u5B57\u7B26",trigger:"blur"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001",trigger:"blur"}],permission_ids:[{required:!0,message:"\u8BF7\u9009\u62E9\u6743\u9650\u8282\u70B9",type:"array",trigger:"change"}]}}),{getTreePermissions:o}=ae(),{formRef:n,item:t,dialog:b,itemLoading:h,confirmLoading:d,cancelItem:s,confirmItem:m}=W("resourceApi"),u=(f,{checkedKeys:c})=>t.value.permission_ids=c;return Q(t,()=>e.defaultCheckedKeys=t.value.permission_ids),I(g({},C(e)),{getTreePermissions:o,formRef:n,item:t,dialog:b,itemLoading:h,confirmLoading:d,cancelItem:s,confirmItem:m,handlePermissionCheck:u})}},ie=p("\u542F\u7528"),se=p("\u7981\u7528"),re=p("\u53D6 \u6D88");function de(e,o,n,t,b,h){const d=H,s=J,m=M,u=O,f=F,c=T,k=X,y=z,r=K;return V(),w(y,{"custom-class":"drawer",title:t.item.id?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272",modelValue:t.dialog,"onUpdate:modelValue":o[4]||(o[4]=i=>t.dialog=i),onClose:t.cancelItem},{default:l(()=>[N(a(k,{ref:"formRef",model:t.item,rules:e.rules,"label-width":"80px",size:"small"},{default:l(()=>[a(s,{label:"\u82F1\u6587\u6807\u8BC6",prop:"name"},{default:l(()=>[a(d,{modelValue:t.item.name,"onUpdate:modelValue":o[0]||(o[0]=i=>t.item.name=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u663E\u793A\u540D\u79F0",prop:"title"},{default:l(()=>[a(d,{modelValue:t.item.title,"onUpdate:modelValue":o[1]||(o[1]=i=>t.item.title=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u89D2\u8272\u5907\u6CE8",prop:"textarea"},{default:l(()=>[a(d,{modelValue:t.item.remark,"onUpdate:modelValue":o[2]||(o[2]=i=>t.item.remark=i),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u89D2\u8272\u72B6\u6001",prop:"status"},{default:l(()=>[a(u,{modelValue:t.item.status,"onUpdate:modelValue":o[3]||(o[3]=i=>t.item.status=i),size:"mini"},{default:l(()=>[a(m,{label:1},{default:l(()=>[ie]),_:1}),a(m,{label:0},{default:l(()=>[se]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"\u8BBF\u95EE\u6388\u6743",prop:"permission_ids"},{default:l(()=>[t.dialog?(V(),w(f,{key:0,data:t.getTreePermissions,props:{children:"children",label:"title"},"default-expanded-keys":[0],"default-checked-keys":e.defaultCheckedKeys,"node-key":"id","show-checkbox":"",style:{height:"100%"},onCheck:t.handlePermissionCheck},null,8,["data","default-checked-keys","onCheck"])):S("",!0)]),_:1}),a(s,null,{default:l(()=>[a(c,{onClick:t.cancelItem,size:"small"},{default:l(()=>[re]),_:1},8,["onClick"]),a(c,{type:"primary",size:"small",onClick:t.confirmItem,loading:t.confirmLoading},{default:l(()=>[p(G(t.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"]),[[r,t.itemLoading]])]),_:1},8,["title","modelValue","onClose"])}var me=D(ne,[["render",de]]);const pe=(e={})=>_.get("/roles",{params:e}),ce=(e={})=>_.get(`/roles/${e.id}`),ue=(e={})=>_.put(`/roles/${e.id}`,{id:e.id,name:e.name,title:e.title,remark:e.remark,status:e.status,permission_ids:e.permission_ids}),_e=(e={})=>_.post("/roles",{name:e.name,title:e.title,remark:e.remark,status:e.status,permission_ids:e.permission_ids}),fe=(e={})=>_.delete(`/roles/${e.id}`),ge=Y({name:"index",components:{BasicQuery:P,BasicTable:E,EditTemplate:me,PageWrapper:A},setup(){const e=B({columns:[{prop:"id",label:"ID",width:100},{prop:"title",label:"\u89D2\u8272\u540D\u79F0",minWidth:100},{prop:"name",label:"\u89D2\u8272\u6807\u8BC6",minWidth:100},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u89D2\u8272ID",component:"Input"},{field:"title",placeholder:"\u89D2\u8272\u540D\u79F0",component:"Input"},{field:"name",placeholder:"\u89D2\u8272\u6807\u8BC6",component:"Input"}]}),o=le({listApi:pe,itemApi:ce,updateApi:ue,storeApi:_e,deleteApi:fe});return Z("resourceApi",o),g(g({},C(e)),C(o))}}),be=p("\u65B0\u589E"),he=p("\u7F16\u8F91 "),ke=p("\u5220\u9664");function ye(e,o,n,t,b,h){const d=T,s=P,m=$,u=ee,f=oe,c=E,k=te("EditTemplate"),y=A;return V(),w(y,{title:e.$route.meta.title},{extra:l(()=>[a(d,{type:"primary",size:"mini",onClick:e.addItem},{default:l(()=>[be]),_:1},8,["onClick"])]),default:l(()=>[a(m,{shadow:"none"},{default:l(()=>[a(s,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=r=>e.query=r),schemas:e.schemas,onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),a(m,{shadow:"none",class:"mt-2"},{default:l(()=>[a(c,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{default:l(()=>[a(f,{label:"\u64CD\u4F5C",width:"120"},{default:l(r=>[a(d,{type:"text",size:"small",disabled:r.row.name==="Administrator",onClick:i=>e.editItem(r.row)},{default:l(()=>[he]),_:2},1032,["disabled","onClick"]),a(u,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:i=>e.deleteItem(r.row)},{reference:l(()=>[a(d,{type:"text",size:"small",disabled:r.row.name==="Administrator"},{default:l(()=>[ke]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),a(k,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=r=>e.dialog=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var Qe=D(ge,[["render",ye]]);export{Qe as default};
