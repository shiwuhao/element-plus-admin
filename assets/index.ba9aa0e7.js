var j=Object.defineProperty,z=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var v=(e,o,s)=>o in e?j(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,b=(e,o)=>{for(var s in o||(o={}))D.call(o,s)&&v(e,s,o[s]);if(B)for(var s of B(o))R.call(o,s)&&v(e,s,o[s]);return e},I=(e,o)=>z(e,U(o));import{P as W}from"./PageWrapper.447ab1ae.js";import{B as q}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.4fa69e75.js";import{B as L}from"./BasicQuery.db35be4a.js";import{B as Q,u as E,a as K}from"./useResourceApi.62b71978.js";import{_ as A,d as f}from"./index.2753bfca.js";import{$ as T,ah as N,B as S,W as C,r as i,o as V,k as w,w as l,b as a,v as x,i as p,t as F,d as G,al as H}from"./vendor.43fc48c7.js";import"./BasicForm.79e36ac9.js";import"./BasicUpload.e683b95d.js";const J={name:"editTemplate",components:{BasicDrawer:Q},setup(){const e=T({defaultCheckedKeys:[],rules:{name:[{required:!0,pattern:/^(\w|:){3,50}$/,message:"\u6807\u8BC6\u4E3A\u5FC5\u586B\u9879\uFF0C3-50\u4E2A\u82F1\u6587\u5B57\u7B26",trigger:"blur"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0",trigger:"blur"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001",trigger:"blur"}],permission_ids:[{required:!0,message:"\u8BF7\u9009\u62E9\u6743\u9650\u8282\u70B9",type:"array",trigger:"change"}]}}),{getTreePermissions:o}=E(),{formRef:s,item:t,dialog:h,itemLoading:k,confirmLoading:r,cancelItem:d,confirmItem:m}=N("resourceApi"),c=(_,{checkedKeys:u})=>t.value.permission_ids=u;return S(t,()=>e.defaultCheckedKeys=t.value.permission_ids),I(b({},C(e)),{getTreePermissions:o,formRef:s,item:t,dialog:h,itemLoading:k,confirmLoading:r,cancelItem:d,confirmItem:m,handlePermissionCheck:c})}},M=p("\u542F\u7528"),O=p("\u7981\u7528"),X=p("\u53D6 \u6D88");function Y(e,o,s,t,h,k){const r=i("el-input"),d=i("el-form-item"),m=i("el-radio-button"),c=i("el-radio-group"),_=i("el-tree"),u=i("el-form"),g=i("el-button"),y=i("BasicDrawer");return V(),w(y,{title:t.item.id?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272",direction:"rtl",size:"50%",loading:t.itemLoading,modelValue:t.dialog,"onUpdate:modelValue":o[4]||(o[4]=n=>t.dialog=n),onClose:t.cancelItem},{default:l(()=>[a(u,{ref:"formRef",model:t.item,rules:e.rules,"label-width":"80px",size:"small"},{default:l(()=>[a(d,{label:"\u82F1\u6587\u6807\u8BC6",prop:"name"},{default:l(()=>[a(r,{modelValue:t.item.name,"onUpdate:modelValue":o[0]||(o[0]=n=>t.item.name=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u663E\u793A\u540D\u79F0",prop:"title"},{default:l(()=>[a(r,{modelValue:t.item.title,"onUpdate:modelValue":o[1]||(o[1]=n=>t.item.title=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u89D2\u8272\u5907\u6CE8",prop:"textarea"},{default:l(()=>[a(r,{modelValue:t.item.remark,"onUpdate:modelValue":o[2]||(o[2]=n=>t.item.remark=n),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u89D2\u8272\u72B6\u6001",prop:"status"},{default:l(()=>[a(c,{modelValue:t.item.status,"onUpdate:modelValue":o[3]||(o[3]=n=>t.item.status=n),size:"mini"},{default:l(()=>[a(m,{label:1},{default:l(()=>[M]),_:1}),a(m,{label:0},{default:l(()=>[O]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"\u8BBF\u95EE\u6388\u6743",prop:"permission_ids"},{default:l(()=>[t.dialog?(V(),w(_,{key:0,data:t.getTreePermissions,props:{children:"children",label:"title"},"default-expanded-keys":[0],"default-checked-keys":e.defaultCheckedKeys,"node-key":"id","show-checkbox":"",style:{height:"100%"},onCheck:t.handlePermissionCheck},null,8,["data","default-checked-keys","onCheck"])):x("",!0)]),_:1})]),_:1},8,["model","rules"])]),footer:l(()=>[a(g,{onClick:t.cancelItem,size:"small"},{default:l(()=>[X]),_:1},8,["onClick"]),a(g,{type:"primary",size:"small",onClick:t.confirmItem,loading:t.confirmLoading},{default:l(()=>[p(F(t.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1},8,["title","loading","modelValue","onClose"])}var Z=A(J,[["render",Y]]);const $=(e={})=>f.get("/roles",{params:e}),ee=(e={})=>f.get(`/roles/${e.id}`),oe=(e={})=>f.put(`/roles/${e.id}`,{id:e.id,name:e.name,title:e.title,remark:e.remark,status:e.status,permission_ids:e.permission_ids}),te=(e={})=>f.post("/roles",{name:e.name,title:e.title,remark:e.remark,status:e.status,permission_ids:e.permission_ids}),ae=(e={})=>f.delete(`/roles/${e.id}`),le=G({name:"index",components:{BasicQuery:L,BasicTable:q,EditTemplate:Z,PageWrapper:W},setup(){const e=T({columns:[{prop:"id",label:"ID",width:100},{prop:"title",label:"\u89D2\u8272\u540D\u79F0",minWidth:100},{prop:"name",label:"\u89D2\u8272\u6807\u8BC6",minWidth:100},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u89D2\u8272ID",component:"Input"},{field:"title",placeholder:"\u89D2\u8272\u540D\u79F0",component:"Input"},{field:"name",placeholder:"\u89D2\u8272\u6807\u8BC6",component:"Input"}]}),o=K({listApi:$,itemApi:ee,updateApi:oe,storeApi:te,deleteApi:ae});return H("resourceApi",o),b(b({},C(e)),C(o))}}),ne=p("\u65B0\u589E"),ie=p("\u7F16\u8F91 "),se=p("\u5220\u9664");function re(e,o,s,t,h,k){const r=i("el-button"),d=i("BasicQuery"),m=i("el-card"),c=i("el-popconfirm"),_=i("el-table-column"),u=i("BasicTable"),g=i("EditTemplate"),y=i("page-wrapper");return V(),w(y,{title:e.$route.meta.title},{extra:l(()=>[a(r,{type:"primary",size:"mini",onClick:e.addItem},{default:l(()=>[ne]),_:1},8,["onClick"])]),default:l(()=>[a(m,{shadow:"none"},{default:l(()=>[a(d,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=n=>e.query=n),schemas:e.schemas,"col-props":{span:6},onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),a(m,{shadow:"none",class:"mt-2"},{default:l(()=>[a(u,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{default:l(()=>[a(_,{label:"\u64CD\u4F5C",width:"120"},{default:l(n=>[a(r,{type:"text",size:"small",disabled:n.row.name==="Administrator",onClick:P=>e.editItem(n.row)},{default:l(()=>[ie]),_:2},1032,["disabled","onClick"]),a(c,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:P=>e.deleteItem(n.row)},{reference:l(()=>[a(r,{type:"text",size:"small",disabled:n.row.name==="Administrator"},{default:l(()=>[se]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),a(g,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=n=>e.dialog=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var he=A(le,[["render",re]]);export{he as default};
