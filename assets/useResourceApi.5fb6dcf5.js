var Q=Object.defineProperty,F=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var P=(t,s,a)=>s in t?Q(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,_=(t,s)=>{for(var a in s||(s={}))W.call(s,a)&&P(t,a,s[a]);if(S)for(var a of S(s))X.call(s,a)&&P(t,a,s[a]);return t},T=(t,s)=>F(t,M(s));import{s as u,B as A,k as K,ao as D,g as y,r as b,E as U,o as Y,c as Z,b as q,w as v,a as C,a2 as R,h as ee,t as te,G as se,z as ae,f as m,ap as oe,a0 as ne,y as re,X as ie,an as le,A as ce,aq as de}from"./vendor.03f63306.js";import{_ as ge,s as p,l as fe}from"./index.f7fbf591.js";const ue={name:"BasicDrawer",setup(t,{emit:s}){const a=u(null),r=u(null);let c=u("");const g=()=>s("update:modelValue",!1);return A(()=>{const{height:l}=K(),{height:i}=D(a),{height:h}=D(r);c.value=y(l)-y(i)-y(h)+"px"}),{drawerClose:g,headerRef:a,footerRef:r,getScrollHeight:c}}},me={class:"drawer-container"},pe={class:"drawer__title",ref:"headerRef"},he={class:"drawer__content"},_e={class:"drawer__footer",ref:"footerRef"};function we(t,s,a,r,c,g){const l=b("el-scrollbar"),i=b("el-drawer"),h=U("loading");return Y(),Z("div",me,[q(i,ae(_(_({},t.$props),t.$attrs),{onClose:r.drawerClose}),{title:v(()=>[C("div",pe,[R(t.$slots,"title",{},()=>[ee(te(t.$attrs.title),1)],!0)],512)]),default:v(()=>[se(q(l,{height:r.getScrollHeight},{default:v(()=>[C("div",he,[R(t.$slots,"default",{},void 0,!0)])]),_:3},8,["height"]),[[h,t.$attrs.loading]]),C("div",_e,[R(t.$slots,"footer",{},void 0,!0)],512)]),_:3},16,["onClose"])])}var Re=ge(ue,[["render",we],["__scopeId","data-v-243e38fc"]]);function Le(){const t=m(()=>p.getters.getConfigs.groups),s=m(()=>p.getters.getConfigs.types),a=m(()=>p.getters.getConfigs.components),r=m(()=>p.getters.getConfigs.permissions),c=m(()=>{const i=fe(oe(p.getters.getConfigs.permissions));return[{id:0,pid:0,title:"\u6839\u8282\u70B9",children:i}]}),g=m(()=>p.getters.getConfigs.roles),l=ne(re().getRoutes().filter(i=>i.meta.menu));return{getGroups:t,getTypes:s,getComponents:a,getPermissions:r,getTreePermissions:c,getRoles:g,getPermissionRoutes:l}}function Ie({listApi:t,itemApi:s,updateApi:a,storeApi:r,deleteApi:c,query:g={},item:l={},paginate:i={},uniqueId:h="id",refreshAfterConfirm:H=!0}){const w=u(null),N=u(null),V=u(null),k=JSON.parse(JSON.stringify(l)),e=le({item:l,query:g,lists:[],dialog:!1,paginate:_({layout:"prev, pager, next, ->, total"},i),listLoading:!1,itemLoading:!1,confirmLoading:!1,refreshAfterConfirm:H}),x=de(async()=>{await d()},1e3),z=async()=>{await x()},d=async()=>{e.listLoading=!0;const{data:{data:o,meta:n}}=await t(e.query).then(f=>f);e.lists=o,n&&(e.paginate.pageSize=n.per_page,e.paginate.total=n.total,e.paginate.pageCount=n.last_page),e.listLoading=!1},L=async o=>{e.itemLoading=!0;const{data:{data:n}}=await s(o).then(f=>f);e.item=n,e.itemLoading=!1},E=()=>{e.dialog=!0},j=async o=>{e.dialog=!0,await L(o)},G=async o=>(await c(o).then(n=>n),e.refreshAfterConfirm&&await d(),Promise.resolve()),I=async()=>{await a(e.item).then(o=>o),e.refreshAfterConfirm&&await d()},B=async()=>{await r(e.item).then(o=>o),e.refreshAfterConfirm&&await d()},J=()=>new Promise(o=>{w.value.validate(async n=>{if(n){try{e.confirmLoading=!0;const{[h]:f}=e.item;f?await I():await B(),$(),e.confirmLoading=!1}catch(f){e.confirmLoading=!1}o()}})}),$=()=>{e.item=k,e.dialog=!1,ce(()=>w.value.clearValidate()).then(o=>o)},O=async o=>{e.query.page=o,await d()};return A(async()=>{await d()}),T(_({},ie(e)),{formRef:w,queryRef:N,tableRef:V,getList:d,getQuery:z,getItem:L,addItem:E,editItem:j,updateItem:I,storeItem:B,deleteItem:G,confirmItem:J,cancelItem:$,changePage:O})}export{Re as B,Ie as a,Le as u};
