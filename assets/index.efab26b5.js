var D=Object.defineProperty,P=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var j=(e,o,r)=>o in e?D(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,g=(e,o)=>{for(var r in o||(o={}))E.call(o,r)&&j(e,r,o[r]);if(v)for(var r of v(o))F.call(o,r)&&j(e,r,o[r]);return e},A=(e,o)=>P(e,Q(o));import{P as S}from"./PageWrapper.df54460f.js";import{B as N}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.49b4a020.js";import{B as G}from"./BasicQuery.7a70fd69.js";import{B as H,u as J,a as K}from"./useResourceApi.b159a6ee.js";import{_ as z,d as c}from"./index.b91482d8.js";import{$ as R,ah as M,W as I,r as s,o as u,k as b,w as l,b as t,c as T,j as U,F as W,i as m,t as L,d as O,al as X}from"./vendor.43fc48c7.js";import"./BasicForm.af22afdc.js";import"./BasicUpload.023550e9.js";const Y={name:"editTemplate",components:{BasicDrawer:H},setup(){const e=R({rules:{username:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],nickname:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],password:[{required:!0,pattern:/^(\w|:|.){3,50}$/,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],status:[{required:!0}]}}),{getRoles:o}=J(),{formRef:r,item:a,dialog:w,itemLoading:h,confirmLoading:i,cancelItem:d,confirmItem:p}=M("resourceApi");return A(g({},I(e)),{getRoles:o,formRef:r,item:a,dialog:w,itemLoading:h,confirmLoading:i,cancelItem:d,confirmItem:p})}},Z=m("\u542F\u7528"),x=m("\u7981\u7528"),$=m("\u53D6 \u6D88");function ee(e,o,r,a,w,h){const i=s("el-input"),d=s("el-form-item"),p=s("el-option"),V=s("el-select"),_=s("el-radio-button"),k=s("el-radio-group"),y=s("el-form"),f=s("el-button"),B=s("BasicDrawer");return u(),b(B,{title:a.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",direction:"rtl",size:"50%",loading:a.itemLoading,modelValue:a.dialog,"onUpdate:modelValue":o[5]||(o[5]=n=>a.dialog=n),onClose:a.cancelItem},{default:l(()=>[t(y,{ref:"formRef",model:a.item,rules:e.rules,"label-width":"80px",size:"small",autocomplete:"off"},{default:l(()=>[t(d,{label:"\u7528\u6237\u6807\u8BC6",prop:"username"},{default:l(()=>[t(i,{modelValue:a.item.username,"onUpdate:modelValue":o[0]||(o[0]=n=>a.item.username=n),placeholder:"\u7528\u6237\u540D\u3001\u624B\u673A\u53F7\u3001\u90AE\u7BB1\u7B49\u552F\u4E00\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:l(()=>[t(i,{modelValue:a.item.nickname,"onUpdate:modelValue":o[1]||(o[1]=n=>a.item.nickname=n),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u5BC6\u7801",prop:a.item.id?"":"password"},{default:l(()=>[t(i,{modelValue:a.item.password,"onUpdate:modelValue":o[2]||(o[2]=n=>a.item.password=n),"show-password":"",minlength:"6",maxlength:"20",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801"},null,8,["modelValue"])]),_:1},8,["prop"]),t(d,{label:"\u7528\u6237\u89D2\u8272"},{default:l(()=>[t(V,{modelValue:a.item.role_ids,"onUpdate:modelValue":o[3]||(o[3]=n=>a.item.role_ids=n),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",style:{width:"100%"}},{default:l(()=>[(u(!0),T(W,null,U(a.getRoles,n=>(u(),b(p,{key:n.id,label:n.title,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u7528\u6237\u72B6\u6001",prop:"status"},{default:l(()=>[t(k,{modelValue:a.item.status,"onUpdate:modelValue":o[4]||(o[4]=n=>a.item.status=n),size:"mini"},{default:l(()=>[t(_,{label:1},{default:l(()=>[Z]),_:1}),t(_,{label:0},{default:l(()=>[x]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),footer:l(()=>[t(f,{onClick:a.cancelItem,size:"small"},{default:l(()=>[$]),_:1},8,["onClick"]),t(f,{type:"primary",size:"small",onClick:a.confirmItem,loading:a.confirmLoading},{default:l(()=>[m(L(a.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1},8,["title","loading","modelValue","onClose"])}var oe=z(Y,[["render",ee]]);const le=(e={})=>c.get("/users",{params:e}),ae=(e={})=>c.get(`/users/${e.id}`),te=(e={})=>c.put(`/users/${e.id}`,{id:e.id,username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),ne=(e={})=>c.post("/users",{username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),se=(e={})=>c.delete(`/users/${e.id}`),re=O({name:"index",components:{BasicQuery:G,BasicTable:N,EditTemplate:oe,PageWrapper:S},setup(){const e=R({columns:[{prop:"id",label:"ID",width:100},{prop:"username",label:"\u7528\u6237\u540D",minWidth:100},{prop:"nickname",label:"\u6635\u79F0",minWidth:100},{prop:"roles",label:"\u89D2\u8272",minWidth:100,slot:"roles"},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u7528\u6237ID",component:"Input"},{field:"username",placeholder:"\u7528\u6237\u540D",component:"Input"},{field:"nickname",placeholder:"\u6635\u79F0",component:"Input"}]}),o=K({listApi:le,itemApi:ae,updateApi:te,storeApi:ne,deleteApi:se});return X("resourceApi",o),g(g({},I(e)),I(o))}}),ie=m("\u65B0\u589E"),de=m("\u7F16\u8F91"),me=m("\u5220\u9664");function pe(e,o,r,a,w,h){const i=s("el-button"),d=s("BasicQuery"),p=s("el-card"),V=s("el-tag"),_=s("el-popconfirm"),k=s("el-table-column"),y=s("BasicTable"),f=s("EditTemplate"),B=s("page-wrapper");return u(),b(B,{title:e.$route.meta.title},{extra:l(()=>[t(i,{type:"primary",size:"mini",onClick:e.addItem},{default:l(()=>[ie]),_:1},8,["onClick"])]),default:l(()=>[t(p,{shadow:"none"},{default:l(()=>[t(d,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=n=>e.query=n),schemas:e.schemas,"col-props":{span:6},onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),t(p,{shadow:"none",class:"mt10"},{default:l(()=>[t(y,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{roles:l(n=>[(u(!0),T(W,null,U(n.row.roles,(C,q)=>(u(),b(V,{class:"mr10",key:q,size:"mini"},{default:l(()=>[m(L(C.title),1)]),_:2},1024))),128))]),default:l(()=>[t(k,{label:"\u64CD\u4F5C",width:"120"},{default:l(n=>[t(i,{type:"text",size:"small",onClick:C=>e.editItem(n.row)},{default:l(()=>[de]),_:2},1032,["onClick"]),t(_,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:C=>e.deleteItem(n.row)},{reference:l(()=>[t(i,{type:"text",size:"small"},{default:l(()=>[me]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),t(f,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=n=>e.dialog=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var ke=z(re,[["render",pe]]);export{ke as default};
