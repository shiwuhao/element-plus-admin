var F=Object.defineProperty,x=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var E=(e,o,s)=>o in e?F(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,b=(e,o)=>{for(var s in o||(o={}))G.call(o,s)&&E(e,s,o[s]);if(v)for(var s of v(o))N.call(o,s)&&E(e,s,o[s]);return e},I=(e,o)=>x(e,S(o));import{_ as B}from"./PageWrapper.dfd017d8.js";import{_ as A}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.9468b605.js";import{at as R,au as O,r as H,b as y,a7 as J,o as u,f as h,w as t,a0 as K,h as a,c as z,G as T,F as U,x as m,t as D,aq as M,av as X,Q as Y,aw as Z,ax as $,ay as L,az as ee,P as oe,d as te,aA as ae,aB as le,a2 as ne,aC as se,aD as ie,U as re}from"./vendor.55f737cb.js";/* empty css                          *//* empty css                      *//* empty css                */import{_ as q}from"./BasicQuery.57c8d1a7.js";import{_ as P,u as de,a as me}from"./useResourceApi.c1aeb902.js";/* empty css                     *//* empty css                       *//* empty css                        */import{_ as W,i as _}from"./index.75b4446f.js";import"./Form.7d241ead.js";/* empty css                 *//* empty css               */import"https://at.alicdn.com/t/font_2915553_2xnkr1mdevd.js";import"https://at.alicdn.com/t/font_2915337_b0wn8zcpm25.js";import"https://at.alicdn.com/t/font_1804572_162pxjij64s.js";const pe={name:"editTemplate",components:{BasicDrawer:P},setup(){const e=R({rules:{username:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],nickname:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],password:[{required:!0,pattern:/^(\w|:|.){3,50}$/,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],status:[{required:!0}]}}),{getRoles:o}=de(),{formRef:s,item:l,dialog:w,itemLoading:V,confirmLoading:d,cancelItem:i,confirmItem:p}=O("resourceApi"),c=H(!0);return I(b({},y(e)),{getRoles:o,formRef:s,item:l,dialog:w,itemLoading:V,confirmLoading:d,cancelItem:i,confirmItem:p,loading:c})}},ue=m("\u542F\u7528"),ce=m("\u7981\u7528"),_e=m("\u53D6 \u6D88");function fe(e,o,s,l,w,V){const d=M,i=X,p=oe,c=Y,f=Z,k=$,g=L,C=ee,j=P,r=J;return u(),h(j,{title:l.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",modelValue:l.dialog,"onUpdate:modelValue":o[5]||(o[5]=n=>l.dialog=n),onClose:l.cancelItem},{default:t(()=>[K(a(C,{ref:"formRef",model:l.item,rules:e.rules,"label-width":"80px",size:"small",autocomplete:"off"},{default:t(()=>[a(i,{label:"\u7528\u6237\u6807\u8BC6",prop:"username"},{default:t(()=>[a(d,{modelValue:l.item.username,"onUpdate:modelValue":o[0]||(o[0]=n=>l.item.username=n),placeholder:"\u7528\u6237\u540D\u3001\u624B\u673A\u53F7\u3001\u90AE\u7BB1\u7B49\u552F\u4E00\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:t(()=>[a(d,{modelValue:l.item.nickname,"onUpdate:modelValue":o[1]||(o[1]=n=>l.item.nickname=n),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u5BC6\u7801",prop:l.item.id?"":"password"},{default:t(()=>[a(d,{modelValue:l.item.password,"onUpdate:modelValue":o[2]||(o[2]=n=>l.item.password=n),"show-password":"",minlength:"6",maxlength:"20",autocomplete:"off",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801"},null,8,["modelValue"])]),_:1},8,["prop"]),a(i,{label:"\u7528\u6237\u89D2\u8272"},{default:t(()=>[a(c,{modelValue:l.item.role_ids,"onUpdate:modelValue":o[3]||(o[3]=n=>l.item.role_ids=n),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",style:{width:"100%"}},{default:t(()=>[(u(!0),z(U,null,T(l.getRoles,n=>(u(),h(p,{key:n.id,label:n.title,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u72B6\u6001",prop:"status"},{default:t(()=>[a(k,{modelValue:l.item.status,"onUpdate:modelValue":o[4]||(o[4]=n=>l.item.status=n),size:"mini"},{default:t(()=>[a(f,{label:1},{default:t(()=>[ue]),_:1}),a(f,{label:0},{default:t(()=>[ce]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(i,null,{default:t(()=>[a(g,{onClick:l.cancelItem,size:"small"},{default:t(()=>[_e]),_:1},8,["onClick"]),a(g,{type:"primary",size:"small",onClick:l.confirmItem,loading:l.confirmLoading},{default:t(()=>[m(D(l.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"]),[[r,l.itemLoading]])]),_:1},8,["title","modelValue","onClose"])}var ge=W(pe,[["render",fe]]);const be=(e={})=>_.get("/users",{params:e}),he=(e={})=>_.get(`/users/${e.id}`),we=(e={})=>_.put(`/users/${e.id}`,{id:e.id,username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),Ve=(e={})=>_.post("/users",{username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),ke=(e={})=>_.delete(`/users/${e.id}`),Ce=te({name:"index",components:{BasicQuery:q,BasicTable:A,EditTemplate:ge,PageWrapper:B},setup(){const e=R({columns:[{prop:"id",label:"ID",width:100},{prop:"username",label:"\u7528\u6237\u540D",minWidth:100},{prop:"nickname",label:"\u6635\u79F0",minWidth:100},{prop:"roles",label:"\u89D2\u8272",minWidth:100,slot:"roles"},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u7528\u6237ID",component:"Input"},{field:"username",placeholder:"\u7528\u6237\u540D",component:"Input"},{field:"nickname",placeholder:"\u6635\u79F0",component:"Input"}]}),o=me({listApi:be,itemApi:he,updateApi:we,storeApi:Ve,deleteApi:ke});return ae("resourceApi",o),b(b({},y(e)),y(o))}}),je=m("\u65B0\u589E"),ye=m("\u7F16\u8F91"),ve=m("\u5220\u9664");function Ee(e,o,s,l,w,V){const d=L,i=q,p=le,c=ne,f=se,k=ie,g=A,C=re("EditTemplate"),j=B;return u(),h(j,{title:e.$route.meta.title},{extra:t(()=>[a(d,{type:"primary",size:"mini",onClick:e.addItem},{default:t(()=>[je]),_:1},8,["onClick"])]),default:t(()=>[a(p,{shadow:"none"},{default:t(()=>[a(i,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=r=>e.query=r),schemas:e.schemas,onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),a(p,{shadow:"none",class:"mt-2"},{default:t(()=>[a(g,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{roles:t(r=>[(u(!0),z(U,null,T(r.row.roles,(n,Q)=>(u(),h(c,{class:"mr-2",key:Q,size:"mini"},{default:t(()=>[m(D(n.title),1)]),_:2},1024))),128))]),default:t(()=>[a(k,{label:"\u64CD\u4F5C",width:"120"},{default:t(r=>[a(d,{type:"text",size:"small",onClick:n=>e.editItem(r.row)},{default:t(()=>[ye]),_:2},1032,["onClick"]),a(f,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:n=>e.deleteItem(r.row)},{reference:t(()=>[a(d,{type:"text",size:"small"},{default:t(()=>[ve]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),a(C,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=r=>e.dialog=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var He=W(Ce,[["render",Ee]]);export{He as default};
