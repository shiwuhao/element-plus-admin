var E=Object.defineProperty,S=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var T=(t,e,s)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,w=(t,e)=>{for(var s in e||(e={}))W.call(e,s)&&T(t,s,e[s]);if(G)for(var s of G(e))F.call(e,s)&&T(t,s,e[s]);return t},q=(t,e)=>S(t,D(e));import{P as Q}from"./PageWrapper.657356fd.js";import{B as N}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.c9c419c8.js";import{B as M}from"./BasicQuery.33a98a39.js";import{B as H,u as j,a as R}from"./useResourceApi.b82e986c.js";import{_ as B,c as O,d as J,e as K,f as X,g as Y,h as Z,j as $,u as ee}from"./index.9f0666ad.js";import{$ as oe,a0 as te,s as U,b as r,G as le,o as c,x as g,w as l,H as ae,e as a,c as k,v as L,F as C,ai as ne,j as V,t as A,B as x,d as re,k as se,a1 as ie,r as I,m as de,a as P}from"./vendor.e9e2b289.js";import{B as z}from"./Form.5248ede4.js";const me={name:"editTemplate",components:{BasicDrawer:H},setup(){const t=oe({rules:{group:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],type:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],component:[{required:!0,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u6807\u8BC6",trigger:"blur"}],title:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u6807\u9898",trigger:"blur"}],extra:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u9879",trigger:"blur"}],value:[{required:!0,message:"\u8BF7\u8F93\u5165\u914D\u7F6E\u503C",trigger:"blur"}]}}),{getGroups:e,getTypes:s,getComponents:o}=j(),{formRef:v,item:b,dialog:u,itemLoading:d,confirmLoading:m,cancelItem:_,confirmItem:p}=te("resourceApi");return q(w({},U(t)),{getGroups:e,getTypes:s,getComponents:o,formRef:v,item:b,dialog:u,itemLoading:d,confirmLoading:m,cancelItem:_,confirmItem:p})}},ue=V("\u53D6 \u6D88");function pe(t,e,s,o,v,b){const u=r("el-option"),d=r("el-select"),m=r("el-form-item"),_=r("el-input"),p=r("el-button"),i=r("el-form"),f=r("BasicDrawer"),y=le("loading");return c(),g(f,{title:o.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",modelValue:o.dialog,"onUpdate:modelValue":e[7]||(e[7]=n=>o.dialog=n),onClose:o.cancelItem},{default:l(()=>[ae(a(i,{ref:"formRef",model:o.item,rules:t.rules,"label-width":"80px",size:"small"},{default:l(()=>[a(m,{label:"\u914D\u7F6E\u5206\u7EC4",prop:"group"},{default:l(()=>[a(d,{modelValue:o.item.group,"onUpdate:modelValue":e[0]||(e[0]=n=>o.item.group=n),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",style:{width:"100%"}},{default:l(()=>[(c(!0),k(C,null,L(o.getGroups,(n,h)=>(c(),g(u,{label:n.label,value:n.value,key:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"\u914D\u7F6E\u7C7B\u578B",prop:"type"},{default:l(()=>[a(d,{modelValue:o.item.type,"onUpdate:modelValue":e[1]||(e[1]=n=>o.item.type=n),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",style:{width:"100%"}},{default:l(()=>[(c(!0),k(C,null,L(o.getTypes,(n,h)=>(c(),g(u,{label:n.label,value:n.value,key:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"\u6E32\u67D3\u7EC4\u4EF6",prop:"component"},{default:l(()=>[a(d,{modelValue:o.item.component,"onUpdate:modelValue":e[2]||(e[2]=n=>o.item.component=n),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",style:{width:"100%"}},{default:l(()=>[(c(!0),k(C,null,L(o.getComponents,(n,h)=>(c(),g(u,{label:n.label,value:n.value,key:h},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"\u914D\u7F6E\u6807\u8BC6",prop:"name"},{default:l(()=>[a(_,{modelValue:o.item.name,"onUpdate:modelValue":e[3]||(e[3]=n=>o.item.name=n),autocomplete:"off"},ne({_:2},[o.item.group?{name:"prepend",fn:l(()=>[V(A(o.item.group),1)])}:void 0]),1032,["modelValue"])]),_:1}),a(m,{label:"\u914D\u7F6E\u540D\u79F0",prop:"title"},{default:l(()=>[a(_,{modelValue:o.item.title,"onUpdate:modelValue":e[4]||(e[4]=n=>o.item.title=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o.item.type==="enum"?(c(),g(m,{key:0,label:"\u914D\u7F6E\u9879",prop:"extra"},{default:l(()=>[a(_,{modelValue:o.item.extra,"onUpdate:modelValue":e[5]||(e[5]=n=>o.item.extra=n),type:"textarea",rows:"3",autocomplete:"off"},null,8,["modelValue"])]),_:1})):x("",!0),a(m,{label:"\u914D\u7F6E\u503C",prop:"value"},{default:l(()=>[a(_,{modelValue:o.item.value,"onUpdate:modelValue":e[6]||(e[6]=n=>o.item.value=n),type:"textarea",rows:"3",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,null,{default:l(()=>[a(p,{onClick:o.cancelItem,size:"small"},{default:l(()=>[ue]),_:1},8,["onClick"]),a(p,{type:"primary",size:"small",onClick:o.confirmItem,loading:o.confirmLoading},{default:l(()=>[V(A(o.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"]),[[y,o.itemLoading]])]),_:1},8,["title","modelValue","onClose"])}var ce=B(me,[["render",pe]]);const _e=re({name:"TableList",components:{BasicQuery:M,BasicTable:N,EditTemplate:ce},setup(){const t=se({columns:[{prop:"id",label:"ID",width:100},{prop:"title",label:"\u6807\u9898",minWidth:100},{prop:"name",label:"\u6807\u8BC6",minWidth:100},{prop:"group_label",label:"\u5206\u7EC4",minWidth:100},{prop:"type_label",label:"\u7C7B\u578B",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"title",placeholder:"\u6807\u9898",component:"Input"},{field:"name",placeholder:"\u6807\u8BC6",component:"Input"}]}),e=R({listApi:O,itemApi:J,updateApi:K,storeApi:X,deleteApi:Y});return ie("resourceApi",e),w(w({},U(t)),U(e))}}),fe=V("\u7F16\u8F91"),ge=V("\u5220\u9664");function be(t,e,s,o,v,b){const u=r("BasicQuery"),d=r("el-card"),m=r("el-button"),_=r("el-popconfirm"),p=r("el-table-column"),i=r("BasicTable"),f=r("EditTemplate");return c(),k(C,null,[a(d,{shadow:"none"},{default:l(()=>[a(u,{modelValue:t.query,"onUpdate:modelValue":e[0]||(e[0]=y=>t.query=y),schemas:t.schemas,onSubmit:t.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),a(d,{shadow:"none",class:"mt-2"},{default:l(()=>[a(i,{columns:t.columns,data:t.lists,paginate:t.paginate,loading:t.listLoading,onChangePage:t.changePage},{default:l(()=>[a(p,{label:"\u64CD\u4F5C",width:"120"},{default:l(y=>[a(m,{type:"text",size:"small",onClick:n=>t.editItem(y.row)},{default:l(()=>[fe]),_:2},1032,["onClick"]),a(_,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:n=>t.deleteItem(y.row)},{reference:l(()=>[a(m,{type:"text",size:"small"},{default:l(()=>[ge]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),a(f,{ref:"editTemplateRef",modelValue:t.dialog,"onUpdate:modelValue":e[1]||(e[1]=y=>t.dialog=y)},null,8,["modelValue"])]),_:1})],64)}var ve=B(_e,[["render",be]]);const ye={name:"GroupList",components:{BasicForm:z},props:["group"],setup(t){const{listLoading:e,confirmLoading:s,query:o,formRef:v,item:b,lists:u,updateItem:d,getList:m}=R({listApi:Z,updateApi:$,query:{group:t.group}}),_=i=>Object.keys(i).map(f=>({value:f,label:i[f]})),p=I([]);return de(u,()=>{b.value={},u.value.forEach(i=>{let f={style:{width:"100%"}};switch(i.component){case"Select":f={options:_(i.parse_extra)};break;case"Upload":f={fileList:[{url:i.parse_value,name:i.parse_value}],limit:1};break}b.value[i.name]=i.value,p.value.push({field:i.name,labelProps:{title:i.title,name:i.name},component:i.component,formProps:{required:!0},componentProps:w({style:{width:"100%"}},f)})})}),{listLoading:e,confirmLoading:s,query:o,formRef:v,form:b,lists:u,schemas:p,updateItem:d,getList:m}}},Ve={class:"label"},he={class:"sub-label"};function we(t,e,s,o,v,b){const u=r("BasicForm");return c(),g(u,{modelValue:o.form,"onUpdate:modelValue":e[0]||(e[0]=d=>o.form=d),"label-position":"top","action-props":{position:"left",submitButtonProps:{loading:o.confirmLoading}},schemas:o.schemas,onSubmit:o.updateItem},{label:l(({labelProps:d})=>[P("span",Ve,A(d.title),1),P("span",he,A(d.name),1)]),_:1},8,["modelValue","action-props","schemas","onSubmit"])}var Be=B(ye,[["render",we],["__scopeId","data-v-660c10aa"]]);const ke={name:"GroupList",components:{BasicForm:z,EditGroup:Be},setup(){const{getGroups:t}=j(),{getIsMobile:e}=ee(),s=I("basic");return{getGroups:t,getIsMobile:e,group:s}}};function Ce(t,e,s,o,v,b){const u=r("EditGroup"),d=r("el-tab-pane"),m=r("el-tabs"),_=r("el-card");return c(),g(_,{shadow:"none"},{default:l(()=>[a(m,{modelValue:o.group,"onUpdate:modelValue":e[0]||(e[0]=p=>o.group=p),"tab-position":o.getIsMobile?"top":"left"},{default:l(()=>[(c(!0),k(C,null,L(o.getGroups,(p,i)=>(c(),g(d,{key:i,label:p.label,name:p.value,lazy:o.group!==p.value},{default:l(()=>[a(u,{group:p.value},null,8,["group"])]),_:2},1032,["label","name","lazy"]))),128))]),_:1},8,["modelValue","tab-position"])]),_:1})}var Le=B(ke,[["render",Ce],["__scopeId","data-v-069560c6"]]);const Ae={name:"index",components:{PageWrapper:Q,TableList:ve,GroupList:Le},setup(){const t=I("config"),e=I(null);return{mode:t,tableListRef:e,handleAdd:()=>e.value.addItem()}}},Ie=V("\u914D\u7F6E\u6A21\u5F0F"),Ue=V("\u7BA1\u7406\u6A21\u5F0F"),xe=V("\u65B0\u589E");function Ge(t,e,s,o,v,b){const u=r("el-radio-button"),d=r("el-radio-group"),m=r("el-button"),_=r("table-list"),p=r("group-list"),i=r("page-wrapper");return c(),g(i,null,{title:l(()=>[a(d,{modelValue:o.mode,"onUpdate:modelValue":e[0]||(e[0]=f=>o.mode=f),size:"mini"},{default:l(()=>[a(u,{label:"config"},{default:l(()=>[Ie]),_:1}),a(u,{label:"manage"},{default:l(()=>[Ue]),_:1})]),_:1},8,["modelValue"])]),extra:l(()=>[a(m,{type:"primary",size:"mini",disabled:o.mode==="config",onClick:o.handleAdd},{default:l(()=>[xe]),_:1},8,["disabled","onClick"])]),default:l(()=>[o.mode==="manage"?(c(),g(_,{key:0,ref:"tableListRef"},null,512)):x("",!0),o.mode==="config"?(c(),g(p,{key:1})):x("",!0)]),_:1})}var De=B(Ae,[["render",Ge]]);export{De as default};
