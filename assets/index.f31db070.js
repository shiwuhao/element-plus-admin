var q=Object.defineProperty,P=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var A=(e,o,r)=>o in e?q(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,w=(e,o)=>{for(var r in o||(o={}))E.call(o,r)&&A(e,r,o[r]);if(I)for(var r of I(o))F.call(o,r)&&A(e,r,o[r]);return e},j=(e,o)=>P(e,Q(o));import{P as S}from"./PageWrapper.657356fd.js";import{B as N}from"./BasicQuery.vue_vue&type=style&index=0&scoped=true&lang.c9c419c8.js";import{B as G}from"./BasicQuery.33a98a39.js";import{B as H,u as x,a as J}from"./useResourceApi.b82e986c.js";import{_ as R,i as f}from"./index.9f0666ad.js";import{$ as T,a0 as K,r as M,s as B,b as s,G as O,o as c,x as h,w as l,H as X,e as a,c as z,v as D,F as U,j as u,t as L,d as Y,a1 as Z}from"./vendor.e9e2b289.js";import"./Form.5248ede4.js";const $={name:"editTemplate",components:{BasicDrawer:H},setup(){const e=T({rules:{username:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u5206\u7EC4",trigger:"change"}],nickname:[{required:!0,message:"\u8BF7\u9009\u62E9\u914D\u7F6E\u7C7B\u578B",trigger:"change"}],password:[{required:!0,pattern:/^(\w|:|.){3,50}$/,message:"\u8BF7\u9009\u62E9\u6E32\u67D3\u7EC4\u4EF6",trigger:"change"}],status:[{required:!0}]}}),{getRoles:o}=x(),{formRef:r,item:t,dialog:V,itemLoading:k,confirmLoading:m,cancelItem:i,confirmItem:p}=K("resourceApi"),_=M(!0);return j(w({},B(e)),{getRoles:o,formRef:r,item:t,dialog:V,itemLoading:k,confirmLoading:m,cancelItem:i,confirmItem:p,loading:_})}},ee=u("\u542F\u7528"),oe=u("\u7981\u7528"),le=u("\u53D6 \u6D88");function ae(e,o,r,t,V,k){const m=s("el-input"),i=s("el-form-item"),p=s("el-option"),_=s("el-select"),g=s("el-radio-button"),y=s("el-radio-group"),b=s("el-button"),C=s("el-form"),v=s("BasicDrawer"),d=O("loading");return c(),h(v,{title:t.item.id?"\u7F16\u8F91\u914D\u7F6E":"\u65B0\u589E\u914D\u7F6E",modelValue:t.dialog,"onUpdate:modelValue":o[5]||(o[5]=n=>t.dialog=n),onClose:t.cancelItem},{default:l(()=>[X(a(C,{ref:"formRef",model:t.item,rules:e.rules,"label-width":"80px",size:"small",autocomplete:"off"},{default:l(()=>[a(i,{label:"\u7528\u6237\u6807\u8BC6",prop:"username"},{default:l(()=>[a(m,{modelValue:t.item.username,"onUpdate:modelValue":o[0]||(o[0]=n=>t.item.username=n),placeholder:"\u7528\u6237\u540D\u3001\u624B\u673A\u53F7\u3001\u90AE\u7BB1\u7B49\u552F\u4E00\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u6635\u79F0",prop:"nickname"},{default:l(()=>[a(m,{modelValue:t.item.nickname,"onUpdate:modelValue":o[1]||(o[1]=n=>t.item.nickname=n),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u5BC6\u7801",prop:t.item.id?"":"password"},{default:l(()=>[a(m,{modelValue:t.item.password,"onUpdate:modelValue":o[2]||(o[2]=n=>t.item.password=n),"show-password":"",minlength:"6",maxlength:"20",autocomplete:"off",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801"},null,8,["modelValue"])]),_:1},8,["prop"]),a(i,{label:"\u7528\u6237\u89D2\u8272"},{default:l(()=>[a(_,{modelValue:t.item.role_ids,"onUpdate:modelValue":o[3]||(o[3]=n=>t.item.role_ids=n),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",style:{width:"100%"}},{default:l(()=>[(c(!0),z(U,null,D(t.getRoles,n=>(c(),h(p,{key:n.id,label:n.title,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"\u7528\u6237\u72B6\u6001",prop:"status"},{default:l(()=>[a(y,{modelValue:t.item.status,"onUpdate:modelValue":o[4]||(o[4]=n=>t.item.status=n),size:"mini"},{default:l(()=>[a(g,{label:1},{default:l(()=>[ee]),_:1}),a(g,{label:0},{default:l(()=>[oe]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(i,null,{default:l(()=>[a(b,{onClick:t.cancelItem,size:"small"},{default:l(()=>[le]),_:1},8,["onClick"]),a(b,{type:"primary",size:"small",onClick:t.confirmItem,loading:t.confirmLoading},{default:l(()=>[u(L(t.confirmLoading?"\u63D0\u4EA4\u4E2D ...":"\u786E \u5B9A"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"]),[[d,t.itemLoading]])]),_:1},8,["title","modelValue","onClose"])}var te=R($,[["render",ae]]);const ne=(e={})=>f.get("/users",{params:e}),se=(e={})=>f.get(`/users/${e.id}`),re=(e={})=>f.put(`/users/${e.id}`,{id:e.id,username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),ie=(e={})=>f.post("/users",{username:e.username,nickname:e.nickname,password:e.password,status:e.status,role_ids:e.role_ids}),de=(e={})=>f.delete(`/users/${e.id}`),me=Y({name:"index",components:{BasicQuery:G,BasicTable:N,EditTemplate:te,PageWrapper:S},setup(){const e=T({columns:[{prop:"id",label:"ID",width:100},{prop:"username",label:"\u7528\u6237\u540D",minWidth:100},{prop:"nickname",label:"\u6635\u79F0",minWidth:100},{prop:"roles",label:"\u89D2\u8272",minWidth:100,slot:"roles"},{prop:"status_label",label:"\u72B6\u6001",minWidth:100},{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4",minWidth:100}],schemas:[{field:"id",placeholder:"\u7528\u6237ID",component:"Input"},{field:"username",placeholder:"\u7528\u6237\u540D",component:"Input"},{field:"nickname",placeholder:"\u6635\u79F0",component:"Input"}]}),o=J({listApi:ne,itemApi:se,updateApi:re,storeApi:ie,deleteApi:de});return Z("resourceApi",o),w(w({},B(e)),B(o))}}),ue=u("\u65B0\u589E"),pe=u("\u7F16\u8F91"),ce=u("\u5220\u9664");function _e(e,o,r,t,V,k){const m=s("el-button"),i=s("BasicQuery"),p=s("el-card"),_=s("el-tag"),g=s("el-popconfirm"),y=s("el-table-column"),b=s("BasicTable"),C=s("EditTemplate"),v=s("page-wrapper");return c(),h(v,{title:e.$route.meta.title},{extra:l(()=>[a(m,{type:"primary",size:"mini",onClick:e.addItem},{default:l(()=>[ue]),_:1},8,["onClick"])]),default:l(()=>[a(p,{shadow:"none"},{default:l(()=>[a(i,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=d=>e.query=d),schemas:e.schemas,onSubmit:e.getQuery},null,8,["modelValue","schemas","onSubmit"])]),_:1}),a(p,{shadow:"none",class:"mt-2"},{default:l(()=>[a(b,{columns:e.columns,data:e.lists,paginate:e.paginate,loading:e.listLoading,onChangePage:e.changePage},{roles:l(d=>[(c(!0),z(U,null,D(d.row.roles,(n,W)=>(c(),h(_,{class:"mr-2",key:W,size:"mini"},{default:l(()=>[u(L(n.title),1)]),_:2},1024))),128))]),default:l(()=>[a(y,{label:"\u64CD\u4F5C",width:"120"},{default:l(d=>[a(m,{type:"text",size:"small",onClick:n=>e.editItem(d.row)},{default:l(()=>[pe]),_:2},1032,["onClick"]),a(g,{title:"\u5220\u9664\u4F60\u662F\u8BA4\u771F\u7684\u5417\uFF1F",iconColor:"red",onConfirm:n=>e.deleteItem(d.row)},{reference:l(()=>[a(m,{type:"text",size:"small"},{default:l(()=>[ce]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["columns","data","paginate","loading","onChangePage"]),a(C,{ref:"editTemplateRef",modelValue:e.dialog,"onUpdate:modelValue":o[1]||(o[1]=d=>e.dialog=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["title"])}var Ce=R(me,[["render",_e]]);export{Ce as default};
