var M=Object.defineProperty,j=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var S=(t,a,s)=>a in t?M(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,y=(t,a)=>{for(var s in a||(a={}))F.call(a,s)&&S(t,s,a[s]);if(R)for(var s of R(a))J.call(a,s)&&S(t,s,a[s]);return t},L=(t,a)=>j(t,E(a));import{_ as Q,u as G,s as d,l as H}from"./index.c91c1e88.js";import{b as K,o as U,c as W,e as X,w as b,a as _,a2 as w,j as Y,t as Z,C as ee,g as u,a6 as te,$ as ae,l as se,s as oe,r as C,k as ne,D as re,q as ie,a7 as le}from"./vendor.e9e2b289.js";const ce={modelValue:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},beforeClose:{type:Function},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},customClass:{type:String},destroyOnClose:{type:Boolean,default:!1},modal:{type:Boolean,default:!0},direction:{type:String,default:"rtl"},size:{type:[String,Number],default:"50%"},title:{type:String},withHeader:{type:Boolean,default:!0},modalClass:{type:String},zIndex:{type:Number}};const de={name:"BasicDrawer",props:ce,setup(t,{emit:a}){const{getIsMobile:s}=G();return{getIsMobile:s,drawerClose:()=>a("update:modelValue",!1)}}},ue={class:"drawer-container"},fe={class:"drawer__title"},pe={class:"drawer__content"},ge={class:"drawer__footer"};function me(t,a,s,r,p,g){const l=K("el-drawer");return U(),W("div",ue,[X(l,ee(t.$props,{size:r.getIsMobile?"100%":t.$props.size,onClose:r.drawerClose}),{title:b(()=>[_("div",fe,[w(t.$slots,"title",{},()=>[Y(Z(t.$props.title),1)],!0)])]),default:b(()=>[_("div",pe,[w(t.$slots,"default",{},void 0,!0)]),_("div",ge,[w(t.$slots,"footer",{},void 0,!0)])]),_:3},16,["size","onClose"])])}var Ce=Q(de,[["render",me],["__scopeId","data-v-30a294ca"]]);function he(){const t=u(()=>d.getters.getConfigs.groups),a=u(()=>d.getters.getConfigs.types),s=u(()=>d.getters.getConfigs.components),r=u(()=>d.getters.getConfigs.permissions),p=u(()=>{const f=H(te(d.getters.getConfigs.permissions));return[{id:0,pid:0,title:"\u6839\u8282\u70B9",children:f}]}),g=u(()=>d.getters.getConfigs.roles),l=ae(se().getRoutes().filter(f=>f.meta.menu));return{getGroups:t,getTypes:a,getComponents:s,getPermissions:r,getTreePermissions:p,getRoles:g,getPermissionRoutes:l}}function ve({listApi:t,itemApi:a,updateApi:s,storeApi:r,deleteApi:p,query:g={},item:l={},paginate:f={},uniqueId:N="id",refreshAfterConfirm:$=!0}){const m=C(null),P=C(null),T=C(null),D=JSON.parse(JSON.stringify(l)),e=ne({item:l,query:g,lists:[],dialog:!1,paginate:y({layout:"prev, pager, next, ->, total"},f),listLoading:!1,itemLoading:!1,confirmLoading:!1,refreshAfterConfirm:$}),k=le(async()=>{await i()},1e3),z=async()=>{await k()},i=async()=>{e.listLoading=!0;const{data:{data:o,meta:n}}=await t(e.query).then(c=>c);e.lists=o,n&&(e.paginate.pageSize=n.per_page,e.paginate.total=n.total,e.paginate.pageCount=n.last_page),e.listLoading=!1},h=async o=>{e.itemLoading=!0;const{data:{data:n}}=await a(o).then(c=>c);e.item=n,e.itemLoading=!1},V=()=>{e.dialog=!0},q=async o=>{e.dialog=!0,await h(o)},A=async o=>(await p(o).then(n=>n),e.refreshAfterConfirm&&await i(),Promise.resolve()),v=async()=>{await s(e.item).then(o=>o),e.refreshAfterConfirm&&await i()},B=async()=>{await r(e.item).then(o=>o),e.refreshAfterConfirm&&await i()},O=()=>new Promise(o=>{m.value.validate(async n=>{if(n){try{e.confirmLoading=!0;const{[N]:c}=e.item;c?await v():await B(),I(),e.confirmLoading=!1}catch(c){e.confirmLoading=!1}o()}})}),I=()=>{e.item=D,e.dialog=!1,re(()=>m.value.clearValidate()).then(o=>o)},x=async o=>{e.query.page=o,await i()};return ie(async()=>{await i()}),L(y({},oe(e)),{formRef:m,queryRef:P,tableRef:T,getList:i,getQuery:z,getItem:h,addItem:V,editItem:q,updateItem:v,storeItem:B,deleteItem:A,confirmItem:O,cancelItem:I,changePage:x})}export{Ce as B,ve as a,he as u};
